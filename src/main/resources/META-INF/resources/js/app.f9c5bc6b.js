(function(e){function t(t){for(var r,o,a=t[0],l=t[1],c=t[2],d=0,u=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&u.push(s[o][0]),s[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);m&&m(t);while(u.length)u.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],r=!0,a=1;a<i.length;a++){var l=i[a];0!==s[l]&&(r=!1)}r&&(n.splice(t--,1),e=o(o.s=i[0]))}return e}var r={},s={app:0},n=[];function o(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=r,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(i,r,function(t){return e[t]}.bind(null,r));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var m=l;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"41d4":function(e,t,i){"use strict";i("d6b9")},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var r=i("2b0e"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[i("transition",[i("keep-alive",{attrs:{include:"Home"}},[i("router-view")],1)],1)],1)},n=[],o=(i("5c0b"),i("2877")),a=i("6544"),l=i.n(a),c=i("7496"),m={},d=Object(o["a"])(m,s,n,!1,null,null,null),u=d.exports;l()(d,{VApp:c["a"]});var p=i("f309");r["a"].use(p["a"]);var v=new p["a"]({theme:{dark:!0}}),h=i("8c4f"),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div")},g=[],b={name:"Home",created:function(){this.$router.push({name:"AppStart"})}},x=b,w=Object(o["a"])(x,f,g,!1,null,null,null),y=w.exports,_=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-app-bar",{attrs:{app:"",dark:""}},[i("v-toolbar-title",[e._v("Options")]),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:e.close}},[i("v-icon",[e._v("mdi-close")])],1)],1),i("v-main",[i("v-card",{attrs:{flat:"",tile:""}},[i("v-container",[i("v-file-input",{attrs:{label:"CSV File",accept:".csv"},model:{value:e.uploadForm.file,callback:function(t){e.$set(e.uploadForm,"file",t)},expression:"uploadForm.file"}}),i("v-text-field",{attrs:{label:"Tags for all items","prepend-icon":"mdi-tag"},model:{value:e.uploadForm.tags,callback:function(t){e.$set(e.uploadForm,"tags",t)},expression:"uploadForm.tags"}}),i("v-btn",{attrs:{elevation:"2"},on:{click:e.upload}},[e._v("Import CSV "),i("v-icon",{attrs:{right:""}},[e._v("mdi-cloud-upload")])],1)],1),i("v-container",[i("v-alert",{attrs:{color:"red",dismissible:"",elevation:"2",type:"error"},model:{value:e.uploadForm.error.visible,callback:function(t){e.$set(e.uploadForm.error,"visible",t)},expression:"uploadForm.error.visible"}},[e._v(e._s(e.uploadForm.error.message))])],1)],1),i("v-divider"),i("v-card",{attrs:{flat:"",tile:""}},[i("v-container",[i("v-btn",{attrs:{elevation:"2"},on:{click:e.permissions}},[e._v("Permissions "),i("v-icon",{attrs:{right:""}},[e._v("mdi-lock")])],1)],1)],1),i("v-divider"),i("v-card",{attrs:{flat:"",tile:""}},[i("v-container",[i("v-btn",{attrs:{elevation:"2"},on:{click:e.logout}},[e._v("Logout "),i("v-icon",{attrs:{right:""}},[e._v("mdi-logout")])],1)],1)],1)],1)],1)},I=[],V={name:"Options",props:{ctx:Object},data:function(){return{uploadForm:{file:null,tags:"",error:{message:"",visible:!1}}}},methods:{logout:function(){this.$emit("logout")},permissions:function(){this.$emit("permissions")},close:function(){this.$emit("close")},upload:function(){var e=this;if(this.uploadForm.file)if(this.uploadForm.file.size>1048576)this.uploadForm.error={message:"The file is too big. Max 1MB.",visible:!0};else{var t=new FormData;t.append("tags",this.uploadForm.tags),t.append("file",this.uploadForm.file),console.log("Uploading..."),this.uploadForm.error={message:"",visible:!1},this.ctx.axios.post("items/import",t,{"Content-Type":"multipart/form-data"}).then((function(t){console.log(t.data),e.uploadForm.error={message:t.data.error,visible:!!t.data.error},t.data.error||e.$emit("items-uploaded")})).catch((function(t){return e.handleError(t)}))}else this.uploadForm.error={message:"Select a file",visible:!0}},handleError:function(e){console.error("API Error",e),this.uploadForm.error={message:e,visible:!0}}}},k=V,L=i("0798"),F=i("40dc"),S=i("8336"),P=i("b0af"),C=i("a523"),T=i("ce7e"),E=i("23a7"),$=i("132d"),O=i("f6c4"),j=i("2fa4"),A=i("8654"),D=i("2a7f"),M=Object(o["a"])(k,_,I,!1,null,null,null),B=M.exports;l()(M,{VAlert:L["a"],VAppBar:F["a"],VBtn:S["a"],VCard:P["a"],VContainer:C["a"],VDivider:T["a"],VFileInput:E["a"],VIcon:$["a"],VMain:O["a"],VSpacer:j["a"],VTextField:A["a"],VToolbarTitle:D["a"]});var R=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Secured",{ref:"secured",attrs:{bypass:e.ctx.viewingSharedLink},on:{"credentials-changed":e.updateCredentials}},[e.displayMain?i("Main",{ref:"main",attrs:{ctx:e.ctx},on:{logout:e.logout}}):e._e()],1)},U=[],q=(i("ac1f"),i("841c"),i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("1276"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"fixed-div"},[i("ItemList",{ref:"itemList",staticClass:"fixed-div",style:e.styleForView(this.views.ItemList),attrs:{ctx:e.ctx},on:{"open-item":e.openItem,"add-item":e.addItem,options:e.options,permissions:e.displayPermissionList}}),i("ItemEdit",{ref:"editItem",staticClass:"fixed-div",style:e.styleForView(this.views.ItemEdit),attrs:{ctx:e.ctx},on:{updated:e.itemUpdated,created:e.itemCreated,deleted:e.itemDeleted,canceled:e.displayList}}),i("Options",{staticClass:"fixed-div",style:e.styleForView(this.views.Options),attrs:{ctx:e.ctx},on:{"items-uploaded":e.refreshItemList,close:e.displayList,permissions:e.permissions,logout:e.logout}}),i("PermissionList",{ref:"permissionList",staticClass:"fixed-div",style:e.styleForView(this.views.PermissionList),attrs:{ctx:e.ctx},on:{"open-permission":e.openPermission,"add-permission":e.addPermission,close:e.displayList}}),i("PermissionEdit",{ref:"editPermission",staticClass:"fixed-div",style:e.styleForView(this.views.PermissionEdit),attrs:{ctx:e.ctx},on:{updated:e.permissionUpdated,created:e.permissionCreated,deleted:e.permissionDeleted,canceled:e.displayPermissionList}})],1)}),z=[],N=(i("b0c0"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"editDiv"}},[i("v-app-bar",{attrs:{app:"",dark:""}},[i("v-toolbar-title",[e._v(e._s(e.title))]),i("v-spacer"),e.isDataCorrect&&!e.readonly?i("v-btn",{attrs:{icon:""},on:{click:e.saveItem}},[i("v-icon",[e._v("mdi-content-save")])],1):e._e(),i("v-btn",{attrs:{icon:""},on:{click:e.cancel}},[i("v-icon",[e._v("mdi-close")])],1)],1),i("v-main",[i("v-card",{attrs:{flat:"",tile:""}},[i("v-container",[i("v-alert",{attrs:{color:"red",dismissible:"",type:"error"},model:{value:e.error.visible,callback:function(t){e.$set(e.error,"visible",t)},expression:"error.visible"}},[e._v(e._s(e.error.message))])],1),i("v-container",[i("v-text-field",{attrs:{readonly:e.readonly,label:"Title"},model:{value:e.itemForm.title,callback:function(t){e.$set(e.itemForm,"title",t)},expression:"itemForm.title"}}),i("v-text-field",{attrs:{readonly:e.readonly,label:"Url","append-icon":e.itemForm.url?"mdi-open-in-new":""},on:{"click:append":e.openUrl},model:{value:e.itemForm.url,callback:function(t){e.$set(e.itemForm,"url",t)},expression:"itemForm.url"}}),i("v-text-field",{attrs:{readonly:e.readonly,label:"Image url","append-icon":e.itemForm.image?"mdi-open-in-new":""},on:{"click:append":e.openImage},model:{value:e.itemForm.image,callback:function(t){e.$set(e.itemForm,"image",t)},expression:"itemForm.image"}}),i("v-textarea",{attrs:{readonly:e.readonly,label:"Notes","auto-grow":"",rows:"1"},model:{value:e.itemForm.notes,callback:function(t){e.$set(e.itemForm,"notes",t)},expression:"itemForm.notes"}}),i("v-text-field",{attrs:{readonly:e.readonly,label:"Tags"},model:{value:e.itemForm.tags,callback:function(t){e.$set(e.itemForm,"tags",t)},expression:"itemForm.tags"}}),i("v-container"),i("v-slider",{attrs:{readonly:e.readonly,label:"Score",color:e.sliderColor,"thumb-label":"always",min:"0",max:"100"},model:{value:e.itemForm.score,callback:function(t){e.$set(e.itemForm,"score",t)},expression:"itemForm.score"}})],1)],1),i("v-divider"),i("v-card",{attrs:{flat:"",tile:""}},[i("v-container",[e.isEditing&&!e.readonly?i("v-btn",{attrs:{color:"error",elevation:"2"},on:{click:e.deleteItem}},[e._v(" Delete "),i("v-icon",{attrs:{right:""}},[e._v("mdi-delete")])],1):e._e()],1)],1)],1)],1)}),J=[],H=(i("498a"),i("4de4"),i("a15b"),i("d4ec")),G=i("bee2"),K=(i("d81d"),function(){function e(){Object(H["a"])(this,e)}return Object(G["a"])(e,null,[{key:"fillItemRawContent",value:function(e){var t=e.title+" "+e.url+" "+e.image+" "+e.notes+" "+this.getTagsString(e)+" "+e.score;e.rawContent=t.toLowerCase()}},{key:"fillPermissionRawContent",value:function(e){e.rawContent=this.getTagsString(e)+" "+e.usernames.join(" ")}},{key:"getTagsString",value:function(e){return e.tags?e.tags.map((function(e){return"#"+e+" "})).join(""):""}},{key:"buildShareLink",value:function(e,t){e.sort();var i=new URL(location.href);return i.protocol+"//"+i.host+"/?user="+t.credentials.username+"&tags="+e.join(",")}},{key:"colorFromScore",value:function(e){return e<10?"red darken-2":e<20?"deep-orange darken-2":e<30?"orange darken-3":e<40?"amber darken-3":e<50?"yellow darken-3":e<60?"grey darken-3":e<70?"blue":e<80?"cyan":e<90?"teal":"green"}},{key:"messageFromApiError",value:function(e){return console.error("API Error",e.response.data,e),e.response.data?e.response.data:e}},{key:"messageObjectFromApiError",value:function(e){return{message:this.messageFromApiError(e),visible:!0}}}]),e}()),Q={name:"ItemEdit",props:{ctx:Object},data:function(){return{itemForm:{},item:null,error:{message:"",visible:!1}}},computed:{readonly:function(){return this.ctx.viewingSharedLink},sliderColor:function(){return K.colorFromScore(this.itemForm.score)},isEditing:function(){return null!=this.item},isDataCorrect:function(){return this.itemForm.title&&this.itemForm.title.trim()},title:function(){return this.readonly?"View Item":this.isEditing?"Edit Item":"Create Item"}},methods:{setItem:function(e){console.log("EditItem:",e?e.title:"(new item)"),this.error={message:"",visible:!1},this.item=e,this.itemForm=this.itemToForm(this.item),this.scrollToTop()},scrollToTop:function(){document.getElementById("editDiv").scrollTop=0},cancel:function(){this.$emit("canceled")},deleteItem:function(){var e=this;this.ctx.axios.post("items/deleteOne",{id:this.item.id}).then((function(){e.$emit("deleted",e.item)})).catch((function(t){return e.handleError(t)}))},saveItem:function(){var e=this,t=this.formToItem(this.itemForm);this.ctx.axios.post("items/upsertOne",t).then((function(t){e.isEditing?e.$emit("updated",{newItem:t.data,oldItem:e.item}):e.$emit("created",t.data)})).catch((function(t){return e.handleError(t)}))},handleError:function(e){this.error=K.messageObjectFromApiError(e),this.scrollToTop()},openUrl:function(){var e=this.itemForm.url;e&&window.open(e)},openImage:function(){var e=this.itemForm.image;e&&window.open(e)},formToItem:function(e){return{id:e.id,userId:e.userId,title:e.title,url:e.url,image:e.image,notes:e.notes,tags:e.tags.trim().split(/[, ]+/).filter((function(e){return!!e})),score:e.score}},itemToForm:function(e){return e?{id:e.id,userId:e.userId,title:e.title,url:e.url,image:e.image,notes:e.notes,tags:e.tags.join(" "),score:e.score}:{id:null,userId:null,title:"",url:"",image:"",notes:"",tags:"",score:50}}}},W=Q,X=i("ba0d"),Y=i("a844"),Z=Object(o["a"])(W,N,J,!1,null,null,null),ee=Z.exports;l()(Z,{VAlert:L["a"],VAppBar:F["a"],VBtn:S["a"],VCard:P["a"],VContainer:C["a"],VDivider:T["a"],VIcon:$["a"],VMain:O["a"],VSlider:X["a"],VSpacer:j["a"],VTextField:A["a"],VTextarea:Y["a"],VToolbarTitle:D["a"]});var te=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"listDiv"}},[i("v-app-bar",{attrs:{app:"",dark:""}},[i("v-toolbar-title",[e._v("Item List")]),i("div",[i("span",{staticStyle:{"margin-left":"10px","font-size":"75%"}},[e._v(" "+e._s(e.itemCount)+" ")])]),i("v-spacer"),e.ctx.credentials?i("v-btn",{attrs:{icon:""},on:{click:e.options}},[i("v-icon",[e._v("mdi-cog")])],1):e._e(),e.ctx.viewingSharedLink?e._e():i("v-btn",{attrs:{icon:""},on:{click:e.addItem}},[i("v-icon",[e._v("mdi-plus")])],1)],1),i("v-main",[i("v-card",{attrs:{flat:"",tile:"",dark:""}},[e.ctx.viewingSharedLink?i("v-container",[i("v-alert",{attrs:{dismissible:"",type:"info"}},[e._v(" Viewing items from user "),i("strong",[e._v(e._s(e.ctx.search.username))]),e._v(" with tags "),i("strong",[e._v(e._s(e.ctx.search.tags.join(", ")))]),e._v(". ")]),e.ctx.viewingMyItems?i("a",{attrs:{href:"#"},on:{click:e.goToPermissions}},[e._v("Edit permissions to allow access")]):e._e()],1):e._e(),i("v-container",[i("v-alert",{attrs:{color:"red",dismissible:"",type:"error"},model:{value:e.error.visible,callback:function(t){e.$set(e.error,"visible",t)},expression:"error.visible"}},[e._v(e._s(e.error.message))])],1),i("v-container",[i("v-text-field",{attrs:{clearable:"",label:"Search",placeholder:"Search words or #tags"},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}}),e.shareable?i("div",[e._v(" Share link: "),i("a",{attrs:{href:e.shareLink(),target:"_blank"}},[e._v(" "+e._s(e.shareLink()))])]):e._e()],1),i("v-list",e._l(e.searchedItems,(function(t){return i("v-list-item",{key:t.id,on:{click:function(i){return e.openItem(t)}}},[i("ItemListItem",{attrs:{item:t}})],1)})),1)],1),i("v-btn",{staticStyle:{"z-index":"3",position:"fixed",right:"20px",bottom:"20px"},attrs:{elevation:"2"},on:{click:e.scrollToTop}},[i("v-icon",[e._v("mdi-chevron-double-up")])],1)],1)],1)},ie=[],re=i("b85c"),se=(i("a434"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(e.item.title)+" ")]),i("v-list-item-subtitle",[e._v(" "+e._s(e.subtitle)+" ")]),i("v-list-item-subtitle",{staticStyle:{color:"#6d6d6d"}},[e._v(" "+e._s(e.subtitle2)+" ")]),i("v-progress-linear",{attrs:{height:"1",color:e.colorForItem(e.item),value:e.item.score}})],1)}),ne=[],oe={name:"ItemListItem",props:{item:Object},computed:{subtitle:function(){return this.item.notes},subtitle2:function(){return K.getTagsString(this.item)}},methods:{colorForItem:function(e){return K.colorFromScore(e.score)}}},ae=oe,le=i("5d23"),ce=i("8e36"),me=Object(o["a"])(ae,se,ne,!1,null,null,null),de=me.exports;l()(me,{VListItemContent:le["a"],VListItemSubtitle:le["b"],VListItemTitle:le["c"],VProgressLinear:ce["a"]});var ue={name:"ItemList",components:{ItemListItem:de},props:{ctx:Object},created:function(){this.retrieveItemsFromApi()},data:function(){return{query:null,items:[],error:{message:"",visible:!1}}},computed:{lowerSearch:function(){return this.query?this.query.trim().toLowerCase():""},shareable:function(){return!!this.ctx.viewingMyItems&&("#"===this.lowerSearch[0]&&(0!==this.searchedItems.length&&0===this.lowerSearch.split(/ +/).filter((function(e){return"#"!==e[0]})).length))},searchedItems:function(){if(!this.lowerSearch)return this.items;var e=this.lowerSearch.split(/ +/).map((function(e){return"#"===e[0]?e+" ":e}));return this.items.filter((function(t){var i,r=Object(re["a"])(e);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(t.rawContent.indexOf(s)<0)return!1}}catch(n){r.e(n)}finally{r.f()}return!0}))},itemCount:function(){return this.lowerSearch?this.searchedItems.length+" of "+this.items.length:this.items.length}},methods:{retrieveItemsFromApi:function(){var e=this;console.log("Loading items from API",this.ctx.search);var t=this.ctx.search;this.ctx.axios.post("items/search",t).then((function(t){return e.prepareItems(t.data)})).catch((function(t){return e.handleError(t)}))},prepareItems:function(e){console.log("Preparing items",e),this.fillRawContent(e.items),this.sortAndSetItems(e.items)},sortAndSetItems:function(e){var t=function(e,t){return e.title<t.title?-1:e.title>t.title?1:0};e.sort(t);for(var i=0;i<e.length;i++)e[i].index=i;this.items=e},fillRawContent:function(e){var t,i=Object(re["a"])(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;K.fillItemRawContent(r)}}catch(s){i.e(s)}finally{i.f()}},addItem:function(){this.$emit("add-item")},openItem:function(e){this.$emit("open-item",e)},itemUpdated:function(e){K.fillItemRawContent(e.newItem),this.items[e.oldItem.index]=e.newItem,this.sortAndSetItems(this.items)},itemAdded:function(e){K.fillItemRawContent(e),this.items.push(e),this.sortAndSetItems(this.items)},itemDeleted:function(e){this.items.splice(e,1),this.sortAndSetItems(this.items)},refreshItems:function(){this.retrieveItemsFromApi()},scrollToTop:function(){document.getElementById("listDiv").scrollTop=0},options:function(){this.$emit("options")},goToPermissions:function(){this.$emit("permissions")},openShareLink:function(){window.open(this.shareLink())},shareLink:function(){var e=this.lowerSearch.split(/ +/).map((function(e){return e.substr(1)}));return K.buildShareLink(e,this.ctx)},handleError:function(e){this.error=K.messageObjectFromApiError(e),this.scrollToTop()}}},pe=ue,ve=i("8860"),he=i("da13"),fe=Object(o["a"])(pe,te,ie,!1,null,null,null),ge=fe.exports;l()(fe,{VAlert:L["a"],VAppBar:F["a"],VBtn:S["a"],VCard:P["a"],VContainer:C["a"],VIcon:$["a"],VList:ve["a"],VListItem:he["a"],VMain:O["a"],VSpacer:j["a"],VTextField:A["a"],VToolbarTitle:D["a"]});var be=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"listDiv"}},[i("v-app-bar",{attrs:{app:"",dark:""}},[i("v-toolbar-title",[e._v("Permissions")]),i("div",[i("span",{staticStyle:{"margin-left":"10px","font-size":"75%"}},[e._v(" "+e._s(e.permissionCount)+" ")])]),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:e.close}},[i("v-icon",[e._v("mdi-close")])],1),i("v-btn",{attrs:{icon:""},on:{click:e.addPermission}},[i("v-icon",[e._v("mdi-plus")])],1)],1),i("v-main",[i("v-card",{attrs:{flat:"",tile:"",dark:""}},[i("v-container",[i("v-alert",{attrs:{color:"red",dismissible:"",type:"error"},model:{value:e.error.visible,callback:function(t){e.$set(e.error,"visible",t)},expression:"error.visible"}},[e._v(e._s(e.error.message))])],1),i("v-container",[i("v-text-field",{attrs:{clearable:"",label:"Search"},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}})],1),i("v-list",e._l(e.searchedPermissions,(function(t){return i("v-list-item",{key:t.id,on:{click:function(i){return e.openPermission(t)}}},[i("PermissionListItem",{attrs:{permission:t}})],1)})),1)],1),i("v-btn",{staticStyle:{"z-index":"3",position:"fixed",right:"20px",bottom:"20px"},attrs:{elevation:"2"},on:{click:e.scrollToTop}},[i("v-icon",[e._v("mdi-chevron-double-up")])],1)],1)],1)},xe=[],we=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-list-item-content",[i("v-list-item-title",[e._v(" "+e._s(e.title)+" ")]),i("v-list-item-subtitle",[e._v(" "+e._s(e.subtitle)+" ")]),i("v-progress-linear",{attrs:{height:"1",color:"grey darken-3",value:"100"}})],1)},ye=[],_e={name:"PermissionListItem",props:{permission:Object},computed:{title:function(){return this.permission.tags.join(" ")},subtitle:function(){return 0===this.permission.usernames.length?"(all users)":this.permission.usernames.join(" ")}}},Ie=_e,Ve=Object(o["a"])(Ie,we,ye,!1,null,null,null),ke=Ve.exports;l()(Ve,{VListItemContent:le["a"],VListItemSubtitle:le["b"],VListItemTitle:le["c"],VProgressLinear:ce["a"]});var Le={name:"PermissionList",components:{PermissionListItem:ke},props:{ctx:Object},created:function(){this.retrievePermissionsFromApi()},data:function(){return{query:null,permissions:[],error:{message:"",visible:!1}}},computed:{lowerSearch:function(){return this.query?this.query.trim().toLowerCase():""},searchedPermissions:function(){if(!this.lowerSearch)return this.permissions;var e=this.lowerSearch.split(/ +/).map((function(e){return"#"===e[0]?e+" ":e}));return this.permissions.filter((function(t){var i,r=Object(re["a"])(e);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(t.rawContent.indexOf(s)<0)return!1}}catch(n){r.e(n)}finally{r.f()}return!0}))},permissionCount:function(){return this.lowerSearch?this.searchedPermissions.length+" of "+this.permissions.length:this.permissions.length}},methods:{retrievePermissionsFromApi:function(){var e=this;console.log("Loading permissions from API",this.ctx.search),this.ctx.axios.post("permissions/search").then((function(t){return e.preparePermissions(t.data)})).catch((function(t){return e.handleError(t)}))},preparePermissions:function(e){console.log("Preparing permissions",e),this.fillRawContent(e.permissions),this.sortAndSetPermissions(e.permissions)},sortAndSetPermissions:function(e){var t=function(e,t){return e.rawContent<t.rawContent?-1:e.rawContent>t.rawContent?1:0};e.sort(t);for(var i=0;i<e.length;i++)e[i].index=i;this.permissions=e},fillRawContent:function(e){var t,i=Object(re["a"])(e);try{for(i.s();!(t=i.n()).done;){var r=t.value;K.fillPermissionRawContent(r)}}catch(s){i.e(s)}finally{i.f()}},addPermission:function(){this.$emit("add-permission")},openPermission:function(e){this.$emit("open-permission",e)},permissionUpdated:function(e){K.fillPermissionRawContent(e.newPermission),this.permissions[e.oldPermission.index]=e.newPermission,this.sortAndSetPermissions(this.permissions)},permissionAdded:function(e){K.fillPermissionRawContent(e),this.permissions.push(e),this.sortAndSetPermissions(this.permissions)},permissionDeleted:function(e){this.permissions.splice(e,1),this.sortAndSetPermissions(this.permissions)},refreshPermissions:function(){this.retrievePermissionsFromApi()},scrollToTop:function(){document.getElementById("listDiv").scrollTop=0},close:function(){this.$emit("close")},handleError:function(e){this.error=K.messageObjectFromApiError(e),this.scrollToTop()}}},Fe=Le,Se=Object(o["a"])(Fe,be,xe,!1,null,null,null),Pe=Se.exports;l()(Se,{VAlert:L["a"],VAppBar:F["a"],VBtn:S["a"],VCard:P["a"],VContainer:C["a"],VIcon:$["a"],VList:ve["a"],VListItem:he["a"],VMain:O["a"],VSpacer:j["a"],VTextField:A["a"],VToolbarTitle:D["a"]});var Ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"editDiv"}},[i("v-app-bar",{attrs:{app:"",dark:""}},[i("v-toolbar-title",[e._v("Edit Permission")]),i("v-spacer"),e.isDataCorrect?i("v-btn",{attrs:{icon:""},on:{click:e.savePermission}},[i("v-icon",[e._v("mdi-content-save")])],1):e._e(),i("v-btn",{attrs:{icon:""},on:{click:e.cancel}},[i("v-icon",[e._v("mdi-close")])],1)],1),i("v-main",[i("v-card",{attrs:{flat:"",tile:""}},[i("v-container",[i("v-alert",{attrs:{color:"red",dismissible:"",type:"error"},model:{value:e.error.visible,callback:function(t){e.$set(e.error,"visible",t)},expression:"error.visible"}},[e._v(e._s(e.error.message))])],1),i("v-container",[i("v-text-field",{attrs:{label:"Tags"},model:{value:e.permissionForm.tags,callback:function(t){e.$set(e.permissionForm,"tags",t)},expression:"permissionForm.tags"}}),e.isDataCorrect?i("div",[e._v(" Share link: "),i("a",{attrs:{href:e.shareLink(),target:"_blank"}},[e._v(" "+e._s(e.shareLink()))])]):e._e(),i("v-text-field",{attrs:{label:"Allowed usernames",placeholder:"Leave empty to allow access to all users"},model:{value:e.permissionForm.usernames,callback:function(t){e.$set(e.permissionForm,"usernames",t)},expression:"permissionForm.usernames"}})],1)],1),i("v-divider"),i("v-card",{attrs:{flat:"",tile:""}},[i("v-container",[e.isEditing?i("v-btn",{attrs:{color:"error",elevation:"2"},on:{click:e.deletePermission}},[e._v(" Delete "),i("v-icon",{attrs:{right:""}},[e._v("mdi-delete")])],1):e._e()],1)],1)],1)],1)},Te=[],Ee={name:"PermissionEdit",props:{ctx:Object},data:function(){return{permissionForm:{},permission:null,error:{message:"",visible:!1}}},computed:{isEditing:function(){return null!=this.permission},isDataCorrect:function(){return this.permissionForm.tags&&this.permissionForm.tags.trim()}},methods:{setPermission:function(e){this.error={message:"",visible:!1},this.permission=e,this.permissionForm=this.permissionToForm(this.permission),this.scrollToTop()},scrollToTop:function(){document.getElementById("editDiv").scrollTop=0},cancel:function(){this.$emit("canceled")},deletePermission:function(){var e=this;this.ctx.axios.post("permissions/deleteOne",{id:this.permission.id}).then((function(){e.$emit("deleted",e.permission)})).catch((function(t){return e.handleError(t)}))},savePermission:function(){var e=this,t=this.formToPermission(this.permissionForm);this.ctx.axios.post("permissions/upsertOne",t).then((function(t){e.isEditing?e.$emit("updated",{newPermission:t.data,oldPermission:e.permission}):e.$emit("created",t.data)})).catch((function(t){return e.handleError(t)}))},shareLink:function(){var e=this.formToPermission(this.permissionForm);return K.buildShareLink(e.tags,this.ctx)},handleError:function(e){this.error=K.messageObjectFromApiError(e),this.scrollToTop()},formToPermission:function(e){return{id:e.id,userId:e.userId,usernames:e.usernames.trim().split(/[, ]+/).filter((function(e){return!!e})),tags:e.tags.trim().split(/[, ]+/).filter((function(e){return!!e}))}},permissionToForm:function(e){return e?{id:e.id,userId:e.userId,usernames:e.usernames.join(" "),tags:e.tags.join(" ")}:{id:null,userId:null,usernames:"",tags:""}}}},$e=Ee,Oe=Object(o["a"])($e,Ce,Te,!1,null,null,null),je=Oe.exports;l()(Oe,{VAlert:L["a"],VAppBar:F["a"],VBtn:S["a"],VCard:P["a"],VContainer:C["a"],VDivider:T["a"],VIcon:$["a"],VMain:O["a"],VSpacer:j["a"],VTextField:A["a"],VToolbarTitle:D["a"]});var Ae={name:"Main",components:{PermissionEdit:je,ItemList:ge,ItemEdit:ee,Options:B,PermissionList:Pe},props:{ctx:Object},created:function(){this.currentView=this.views.ItemList},data:function(){return{views:{ItemList:"ItemList",ItemEdit:"ItemEdit",Options:"Options",PermissionList:"PermissionList",PermissionEdit:"PermissionEdit"},currentView:null}},methods:{addItem:function(){this.displayItemEdit(null)},openItem:function(e){console.log("Main: open item",e.id,e.title),this.displayItemEdit(e)},displayItemEdit:function(e){var t=this;this.$refs.editItem.setItem(e),setTimeout((function(){t.currentView=t.views.ItemEdit}),300)},itemUpdated:function(e){console.log("Main: item updated",e),this.$refs.itemList.itemUpdated(e),this.displayList()},itemCreated:function(e){console.log("Main: item created",e.title),this.$refs.itemList.itemAdded(e),this.displayList()},itemDeleted:function(e){console.log("Main: item deleted",e.id,e.index,e.title),this.$refs.itemList.itemDeleted(e.index),this.displayList()},refreshItemList:function(){this.$refs.itemList.refreshItems(),this.displayList()},displayList:function(){this.currentView=this.views.ItemList},addPermission:function(){this.displayPermissionEdit(null)},openPermission:function(e){console.log("Main: open permission",e.id,e.tags),this.displayPermissionEdit(e)},displayPermissionEdit:function(e){var t=this;this.$refs.editPermission.setPermission(e),setTimeout((function(){t.currentView=t.views.PermissionEdit}),300)},permissionUpdated:function(e){console.log("Main: permission updated",e),this.$refs.permissionList.permissionUpdated(e),this.displayPermissionList()},permissionCreated:function(e){console.log("Main: permission created",e.tags),this.$refs.permissionList.permissionAdded(e),this.displayPermissionList()},permissionDeleted:function(e){console.log("Main: permission deleted",e.id,e.index,e.tags),this.$refs.permissionList.permissionDeleted(e.index),this.displayPermissionList()},refreshPermissionList:function(){this.$refs.permissionList.refreshPermissions(),this.displayPermissionList()},displayPermissionList:function(){this.currentView=this.views.PermissionList},handleError:function(e){console.error("API Error",e)},onNavigation:function(e,t){console.log("Tried to navigate from "+t.name+" to "+e.name),this.currentView===this.views.ItemList?this.ctx.viewingSharedLink&&(location.href="/"):this.displayList()},styleForView:function(e){return{zIndex:this.currentView===e?2:1}},options:function(){this.currentView=this.views.Options},permissions:function(){this.currentView=this.views.PermissionList},logout:function(){this.$emit("logout")}}},De=Ae,Me=(i("41d4"),Object(o["a"])(De,q,z,!1,null,"206d5f1a",null)),Be=Me.exports,Re=i("bc3a"),Ue=i.n(Re),qe=r["a"].config.devtools;console.log("Development mode?",qe);var ze={apiUrl:qe?"http://localhost:8070/":""},Ne=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.credentials||e.bypass?i("div",[e._t("default")],2):i("div",[i("Login",{on:{login:e.login}})],1)},Je=[],He=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-app-bar",{attrs:{app:"",dark:""}},[i("v-toolbar-title",[e._v("Login")]),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:function(t){return e.loginOrRegister()}}},[i("v-icon",[e._v("mdi-login")])],1)],1),i("v-main",[i("v-card",{attrs:{flat:"",tile:"",dark:""}},[i("v-container",[i("v-text-field",{attrs:{label:"username","auto-grow":"",rows:"1"},model:{value:e.loginData.username,callback:function(t){e.$set(e.loginData,"username",t)},expression:"loginData.username"}}),i("v-text-field",{attrs:{type:"password",label:"password","auto-grow":"",rows:"1"},model:{value:e.loginData.password,callback:function(t){e.$set(e.loginData,"password",t)},expression:"loginData.password"}}),i("v-text-field",{attrs:{type:"password",label:"repeat password to register","auto-grow":"",rows:"1"},model:{value:e.loginData.password2,callback:function(t){e.$set(e.loginData,"password2",t)},expression:"loginData.password2"}}),i("p",{staticStyle:{color:"red"}},[e._v(e._s(e.error))])],1)],1)],1)],1)},Ge=[],Ke={name:"Login",data:function(){return{loginData:{username:"",password:"",password2:""},error:""}},methods:{loginOrRegister:function(){var e,t=this;if(this.error="",this.loginData.password2){if(this.loginData.password!==this.loginData.password2)return void(this.error="Passwords don't match");e="register"}else e="login";console.log("Login: ",e),Ue.a.post(ze.apiUrl+"/security/"+e,this.loginData).then((function(e){return t.handleCredentials(e.data)})).catch((function(e){return t.handleError(e)}))},handleCredentials:function(e){this.$emit("login",e)},handleError:function(e){this.error=e}}},Qe=Ke,We=Object(o["a"])(Qe,He,Ge,!1,null,null,null),Xe=We.exports;l()(We,{VAppBar:F["a"],VBtn:S["a"],VCard:P["a"],VContainer:C["a"],VIcon:$["a"],VMain:O["a"],VSpacer:j["a"],VTextField:A["a"],VToolbarTitle:D["a"]});var Ye=i("a78e"),Ze=i.n(Ye),et={name:"Secured",components:{Login:Xe},created:function(){this.reloadCredentials()},props:{bypass:Boolean},data:function(){return{credentials:null}},methods:{login:function(e){console.log("Secured: storing cookies for credentials");var t=JSON.stringify(e);Ze.a.set("credentials",t,{sameSite:"strict"}),this.reloadCredentials()},logout:function(){this.removeCredentials()},removeCredentials:function(){console.log("Secured: removing credentials"),Ze.a.remove("credentials"),this.updateCredentials(null)},reloadCredentials:function(){console.log("Secured: reloading credentials");var e=Ze.a.get("credentials");e?(console.log("Secured: credentials found"),this.updateCredentials(JSON.parse(e))):(console.log("Secured: credentials not found"),this.removeCredentials())},updateCredentials:function(e){console.log("Secured: updating credentials"),this.credentials=e,this.$emit("credentials-changed",e)}}},tt=et,it=Object(o["a"])(tt,Ne,Je,!1,null,null,null),rt=it.exports,st={name:"AppStart",components:{Secured:rt,Main:Be},data:function(){return{ctx:{},displayMain:!1}},created:function(){},methods:{updateCredentials:function(e){console.log("Main: update credentials",e);var t=this.createSearchFromSharedLink();this.ctx.viewingSharedLink=null!==t,this.ctx.credentials=e,this.ctx.axios=this.createAxiosInstance(e);var i=e||this.ctx.viewingSharedLink;i?(this.ctx.search=t||{username:e.username},this.ctx.viewingMyItems=e&&e.username===this.ctx.search.username,this.displayMain=!0):this.displayMain=!1},createSearchFromSharedLink:function(){var e=window.location.search;if(!e)return null;var t=new URLSearchParams(e);return{username:t.get("user"),tags:t.get("tags").split(",")}},createAxiosInstance:function(e){console.log("Creating axios instance");var t={baseURL:ze.apiUrl};return e&&(t.headers={Authorization:"Bearer "+e.token}),Ue.a.create(t)},logout:function(){this.$refs.secured.logout(),location.href="/"}},beforeRouteLeave:function(e,t,i){console.log("Navigation intercepted"),i(!1),this.displayMain&&this.$refs.main.onNavigation(e,t)}},nt=st,ot=Object(o["a"])(nt,R,U,!1,null,null,null),at=ot.exports,lt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("SampleComponent")},ct=[],mt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("v-app-bar",{attrs:{app:"",dark:""}},[i("v-toolbar-title",[e._v(e._s(e.title))]),i("v-spacer"),i("v-btn",{attrs:{icon:""},on:{click:e.method}},[i("v-icon",[e._v("mdi-cog")])],1)],1),i("v-main",[i("v-card",{attrs:{flat:"",tile:"",dark:""}},[i("v-container",[e._v(" "+e._s(e.message)+" ")])],1)],1)],1)},dt=[],ut={name:"SampleComponent",props:{ctx:Object},created:function(){this.message="Component created"},data:function(){return{title:"Sample component",message:null}},methods:{method:function(){var e=K.colorFromScore(75);console.log("Color: "+e)}}},pt=ut,vt=Object(o["a"])(pt,mt,dt,!1,null,null,null),ht=vt.exports;l()(vt,{VAppBar:F["a"],VBtn:S["a"],VCard:P["a"],VContainer:C["a"],VIcon:$["a"],VMain:O["a"],VSpacer:j["a"],VToolbarTitle:D["a"]});var ft={name:"SampleView",components:{SampleComponent:ht},beforeRouteLeave:function(e,t,i){console.log("Going back"),"A"===t.name&&"B"===e.name?i():i(!1)}},gt=ft,bt=Object(o["a"])(gt,lt,ct,!1,null,null,null),xt=bt.exports;r["a"].use(h["a"]);var wt=[{path:"/",name:"Home",component:y},{path:"/app",name:"AppStart",component:at},{path:"/sample",name:"SampleView",component:xt},{path:"/options",name:"Options",component:B}],yt=new h["a"]({base:"/",routes:wt}),_t=yt;r["a"].config.productionTip=!1,new r["a"]({vuetify:v,router:_t,render:function(e){return e(u)}}).$mount("#app")},"5c0b":function(e,t,i){"use strict";i("9c0c")},"9c0c":function(e,t,i){},d6b9:function(e,t,i){}});
//# sourceMappingURL=app.f9c5bc6b.js.map